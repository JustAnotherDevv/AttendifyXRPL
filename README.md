# Attendify XRPL API library

(Demo showcasing how to use it)[https://youtu.be/YLdJcGXUpjI]

## Project information

Attendify is an API for PoA(proof of attendance system) built on the XRP ledger that can provide easy and secure way to mint and distribute NFTs or verify attendance at a wide range of events and activities happening in real life or online. Few potential uses for it are: 

⚫University students can use the system to quickly verify attendance at lectures, seminars or other educational events. 

⚫Large events like conferences etc where it can be difficult to keep track of who has attended and who didn't. 

⚫Verifying employee showing up at meetings, training sessions etc.

Project was firstly developed during [XRPL NFT hackathon.](https://devpost.com/software/xrp-nft-attendence)

## Features

⚫ Creating new events and batch minting NFTs for it

⚫ Uploading NFT metadata to IPFS

⚫ Checking if it's possible to claim NFTs for particular event

⚫ Requesting claim for NFT from particular event. The new sell offer for NFT that has to be accepted by the user is returned

⚫ Event attendees lookup

⚫ NFT ownership verification

## Documentation

### Attendify.js

⚫ Current version of documentation for Attendify.js is in the `docs` folder and was generated by jsdoc. Latest version of docs is hosted [here](https://justanotherdevv.github.io/AttendifyXRPL/Attendify.html).

### REST API endpoints

This API is built using the ExpressJS framework and the XRPL library, it connect to the local Attendify.js class to perform most of the actions. 

⚫ `GET /api/mint` - Creates new claimable event and premints NFTs for it. You must have at least X XRP in order to use this to handle the reserve requirements for the NFTs and the minting process which uses [Tickets](https://xrpl.org/tickets.html), where X is amount of tokens that should be minted multiplied by 2 + additional XRP for feees.

**@param {string} walletAddress** - Wallet address from user requesting claim

**@param {integer} tokenCount** - Amount of NFTs that should be created for the event

**@param {string} url** - Url to Image for event | Preferably this should be stored on IPFS

**@param {string} title** - Title for event

**@param {string} desc** - Description of event

**@param {string} loc** - Location of event

Example request `http://localhost:4000/api/mint?walletAddress=rpHJL8bRW81shYm3LwwsXovABps6SM51RS&tokenCount=5&url=ipfs://QmQDDD1cNgnyhPC4pBLZKhVeu12oyfCAJoWr1Qc1QgbkPN&title=test_title&desc=test_description&loc=Warsaw`

⚫ `GET /api/claim` - Checks if user is eligible for NFT claim or creates new offer that allows for claiming NFT for specific event. Endpoint returns response with sellOfferID that has to be accepted by user afterwards.

**@param {string} walletAddress** - The wallet address of the user trying to claim

**@param {integer} type** - The type of claim (1 for checking claim status and metadata, 2 for claiming)

**@param {string} minter** - The minter address of the event

**@param {string} eventId** - The ID of the event

**Possible responses**

    -`404` - Event with specified ID does not exist

    -`claimed` - The NFT for specified event was already claimed by this user

    -`empty` - All NFTs for this particular event were already claimed

    -`success` - If `onlyCheckStatus` parameter was true it indicated that current parameters for selected event were sent

    -`transferred` - Indicates that new sell offer for NFT related to selected event was created successfully and details were sent to user
    
Example request `http://localhost:4000/api/claim?walletAddress=rpHJL8bRW81shYm3LwwsXovABps6SM51RS&type=2&minter=rMBU1wwAJZZz36YBNxug7YYHKeC5k3vqfG&eventId=0`

⚫ `GET /api/verifyOwnership` - Verifies whether or not user owns NFT with provided id for particular event from `minter` account.

**@param {string} walletAddress** - Wallet address from user requesting verification

**@param {string} signature** - Signature that should be signed by the same account as walletAddress. This could be done either using XUMM or `sign` function from xrpl library

**@param {string} minter** - The minter address of the event

**@param {string} eventId** - The ID of the event

Example request `http://localhost:4000/api/verifyOwnership?walletAddress=raY33uxEbZFg7YS1ofFRioeENLsVdCgpC5&signature=12000022800000002401469CC8201B00779113614000000000C65D4068400000000000000D7321ED57D41105FC480545763677D2100C8949324A97811FE5CB45594B5E73991BBF927440625FEB2E8DEA86736368DE716C0223586C97C44519B45500653F7C505DA9C24F3F8789BBEE917871DC862DB826ACE7B64AB485BADB0C46776E931EA0EC55840381143CBB7B1E0212681492733BDA77986A6A7C4C2B4A83144B4E9C06F24296074F7BC48F92A97916C6DC5EA9&minter=raY33uxEbZFg7YS1ofFRioeENLsVdCgpC5&eventId=0`

⚫ `GET /api/attendees` - Looks up attendees for event with specific id with NFTs create by minter address.

**@param {string} minter** - The minter address of the event

**@param {string} eventId** - The ID of the event

Example request `http://localhost:4000/api/attendees?minter=raY33uxEbZFg7YS1ofFRioeENLsVdCgpC5&eventId=0`

## ToDo

⚫ Whitelist system

⚫ Configuration: e.g. choosing whether or not NFTs are soulbound

⚫ If called again by the same user the claim endpoint should check if sell offer that wasn't accepted exists and it should be returned instead of showing that NFT was claimed

⚫ Checking whether or not deadline for claiming NFTs has passed

⚫ Integration with updated UI and XUMM wallet

## How to setup

⚫execute `npm i` in CLI

⚫copy .env.example content to .env file and fill with your data and API keys

⚫execute `npm run start` in CLI to start the server

⚫execute `npm run test` to start test process
